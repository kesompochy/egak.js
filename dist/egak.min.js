!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("EGAK",[],t):"object"==typeof exports?exports.EGAK=t():e.EGAK=t()}(self,(function(){return(()=>{"use strict";var e={840:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n="#version 300 es\r\nprecision highp float;\r\n\r\nin vec2 v_texcoord;\r\n\r\nuniform sampler2D u_texture;\r\n\r\nuniform float u_opacity;\r\n\r\nout vec4 outColor;\r\n\r\nvoid main() {\r\n   outColor = texture(u_texture, v_texcoord) * vec4(1, 1, 1, u_opacity);\r\n}"},289:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n="#version 300 es\r\n \r\nin vec2 a_position;\r\nin vec2 a_texcoord;\r\n \r\nuniform mat3 u_transformation;\r\n \r\nout vec2 v_texcoord;\r\n \r\nvoid main() {\r\n   v_texcoord = a_texcoord;\r\n\r\n   gl_Position = vec4((u_transformation * vec3(a_position, 1)).xy, 0, 1);\r\n}"},178:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultResolution=void 0;var i=n(r(947)),o=n(r(547)),a=n(r(439)),u={width:300,height:150,canvas:document.createElement("canvas"),autoStyleCanvas:!1};t.defaultResolution={x:1,y:1};var s=function(){function e(e){this.baseContainer=new o.default,this.loader=new a.default;var r=(e=Object.assign(u,e)).width,n=e.height,s=e.canvas,c=e.autoStyleCanvas;this.canvas=s,c&&(this.canvas.style.width="".concat(r,"px"),this.canvas.style.height="".concat(n,"px")),this.screenSize={width:r,height:n},this.renderer=new i.default({canvas:s,width:this.screenSize.width,height:this.screenSize.height}),this.resolution=t.defaultResolution,this.resolution.x=this.canvas.width/this.screenSize.width,this.resolution.y=this.canvas.height/this.screenSize.height}return Object.defineProperty(e.prototype,"width",{set:function(e){this.screenSize.width=e,this.resolution.x=this.canvas.width/this.screenSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{set:function(e){this.screenSize.height=e,this.resolution.y=this.canvas.height/this.screenSize.height},enumerable:!1,configurable:!0}),e.prototype.loopRender=function(){this.renderer.clear(233,233,233),this.baseContainer.render(this.renderer),this.renderer.flush(),requestAnimationFrame(this.loopRender.bind(this))},e.prototype.start=function(){requestAnimationFrame(this.loopRender.bind(this))},e}();t.default=s},439:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.resources=new Map,this.tasks=[],this._loadThen=function(){}}return e.prototype.addImage=function(e,t){var r=this._promiseLoadingImage(e,t);return this.tasks.push(r),this},e.prototype.loadAll=function(){var e=this;Promise.all(this.tasks).then((function(){e._loadThen()}))},e.prototype._promiseLoadingImage=function(e,t){var r=this,n=new Image;return n.src=t,new Promise((function(t){n.addEventListener("load",(function(){r.resources.set(e,n),t(n)}))}))},e.prototype.loadThen=function(e){this._loadThen=e},e.prototype.get=function(e){if(this.resources.has(e))return this.resources.get(e);throw new Error("there is no texture named '".concat(e,"."))},e}();t.default=r},309:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.position={x:0,y:0},this._opacity=1,this.scale={x:1,y:1,set:function(e){this.x=e,this.y=e}},this.rotation=0}return Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity=Math.min(Math.max(e,0),1)},enumerable:!1,configurable:!0}),e}();t.default=r},547:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return a(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=s(r(309)),l=u(r(179)),f=function(e){function t(){var t=e.call(this)||this;return t.anchor={x:0,y:0},t.transform=l.identity(),t.parentTransform=l.identity(),t.parentOpacity=1,t.parent=void 0,t.renderingFunc=function(e){},t.children=[],t}return i(t,e),t.prototype.render=function(e){this.transform=this.calculateTransform(),this.parentTransform=this.calculateParentTransform(),this.parentOpacity=this.calculateParentOpacity(),this.renderingFunc(e);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].render(e)},t.prototype.addChild=function(e){return this.children.push(e),e.parent=this,this},t.prototype.calculateTransform=function(){var e=l.translation(this.position.x,this.position.y),t=l.scaling(this.scale.x,this.scale.y),r=l.rotation(this.rotation),n=l.translation(-this.anchor.x,-this.anchor.y);return l.someMultiply(e,r,t,n)},t.prototype.calculateParentTransform=function(){return this.parent?l.multiply(this.parent.parentTransform,this.parent.transform):l.identity()},t.prototype.calculateParentOpacity=function(){return this.parent?this.parent.parentOpacity*this.parent.opacity:1},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.position.y=e},enumerable:!1,configurable:!0}),t}(c.default);t.default=f},339:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return a(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=s(r(547)),l=u(r(179)),f=function(e){function t(t){var r=e.call(this)||this;return r.transform=l.identity(),r.renderingFunc=function(e){e.renderSprite(r)},t&&(r.texture=t),r}return i(t,e),t}(c.default);t.default=f},736:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TextStyle=void 0;var a=o(r(339)),u=o(r(59)),s=r(178),c=function(){this.font="sans-serif",this.fontSize=20,this.fill="0x000000"};t.TextStyle=c;var l=function(e){function t(t,r,n){void 0===n&&(n=s.defaultResolution);var i=e.call(this)||this;i._text="",i._canvas=document.createElement("canvas"),i._resolution={x:1,y:1},i._text=t||"",i._style=r||new c,i._style.font=(null==r?void 0:r.font)||"sans-serif",i._resolution=n,i.drawCanvas();var o=new u.default(i._canvas,"NEAREST");return i.texture=o,i}return i(t,e),t.prototype.drawCanvas=function(){var e=this._canvas,t=e.getContext("2d"),r=this._style,n=this._text;t.clearRect(0,0,e.width,e.height),e.width=2,e.height=2,t.font="".concat(r.fontSize,"px ").concat(r.font),t.textBaseline="top";var i=t.measureText(n),o=i.width,a=i.actualBoundingBoxDescent-i.actualBoundingBoxAscent;e.width=o*this._resolution.x,e.height=a*this._resolution.y,t.scale(this._resolution.x,this._resolution.y),t.font="".concat(r.fontSize,"px ").concat(r.font),t.textBaseline="top",t.fillStyle=r.fill,t.fillText(n,0,0),this.scale.x=1/this._resolution.x,this.scale.y=1/this._resolution.y},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this.drawCanvas(),this.texture.updated=!1},enumerable:!1,configurable:!0}),t}(a.default);t.default=l},607:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Text=t.Container=t.Texture=t.Sprite=t.App=void 0;var i=n(r(178));t.App=i.default;var o=n(r(339));t.Sprite=o.default;var a=n(r(59));t.Texture=a.default;var u=n(r(547));t.Container=u.default;var s=n(r(736));t.Text=s.default},179:(e,t)=>{function r(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=t[0],h=t[1],d=t[2],p=t[3],_=t[4],v=t[5],y=t[6],g=t[7],m=t[8];return[f*r+h*o+d*s,f*n+h*a+d*c,f*i+h*u+d*l,p*r+_*o+v*s,p*n+_*a+v*c,p*i+_*u+v*l,y*r+g*o+m*s,y*n+g*a+m*c,y*i+g*u+m*l]}Object.defineProperty(t,"__esModule",{value:!0}),t.identity=t.someMultiply=t.multiply=t.rotation=t.translation=t.scaling=t.projection=void 0,t.projection=function(e,t){return[2/e,0,0,0,-2/t,0,-1,1,1]},t.scaling=function(e,t){return[e,0,0,0,t,0,0,0,1]},t.translation=function(e,t){return[1,0,0,0,1,0,e,t,1]},t.rotation=function(e){var t=Math.sin(e),r=Math.cos(e);return[r,-t,0,t,r,0,0,0,1]},t.multiply=r,t.someMultiply=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e[0],i=0,o=e.length-1;i<o;i++)n=r(n,e[i+1]);return n},t.identity=function(){return[1,0,0,0,1,0,0,0,1]}},478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableAlpha=void 0,t.enableAlpha=function(e){e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)}},144:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRectangleIndices=t.createLinkedVertexBuffer=void 0,t.createLinkedVertexBuffer=function(e,t,r,n){var i=e.getAttribLocation(t,r),o=e.getAttribLocation(t,n);e.enableVertexAttribArray(i),e.enableVertexAttribArray(o);var a=e.FLOAT,u=4*Float32Array.BYTES_PER_ELEMENT,s=2*Float32Array.BYTES_PER_ELEMENT,c=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,c),e.vertexAttribPointer(i,2,a,!1,u,0),e.vertexAttribPointer(o,2,a,!1,u,s),e.bindBuffer(e.ARRAY_BUFFER,null),c},t.createRectangleIndices=function(e){var t=new Uint16Array([0,1,2,1,3,2]),r=function(e,t,r){var n=e.createBuffer();return e.bindBuffer(t,n),e.bufferData(t,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),n}(e,e.ELEMENT_ARRAY_BUFFER,t);return r}},484:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resizeCanvas=t.clearCanvas=void 0,t.clearCanvas=function(e,t){var r=t.r/256,n=t.g/256,i=t.b/256,o=void 0===t.a?1:t.a;e.clearColor(r,n,i,o),e.clear(e.COLOR_BUFFER_BIT)},t.resizeCanvas=function(e,t){var r=e.canvas,n=r.clientWidth,i=r.clientHeight;r.width=n*t,r.height=i*t,e.viewport(0,0,r.width,r.height)}},97:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUniformLocation=t.resizeCanvas=t.clearCanvas=t.enableAlpha=t.uploadTexture=t.createTexture=t.createLinkedVertexBuffer=t.createRectangleIndices=t.createProgram=void 0;var n=r(381);Object.defineProperty(t,"createProgram",{enumerable:!0,get:function(){return n.createProgram}});var i=r(144);Object.defineProperty(t,"createLinkedVertexBuffer",{enumerable:!0,get:function(){return i.createLinkedVertexBuffer}}),Object.defineProperty(t,"createRectangleIndices",{enumerable:!0,get:function(){return i.createRectangleIndices}});var o=r(363);Object.defineProperty(t,"createTexture",{enumerable:!0,get:function(){return o.createTexture}}),Object.defineProperty(t,"uploadTexture",{enumerable:!0,get:function(){return o.uploadTexture}});var a=r(478);Object.defineProperty(t,"enableAlpha",{enumerable:!0,get:function(){return a.enableAlpha}});var u=r(484);Object.defineProperty(t,"clearCanvas",{enumerable:!0,get:function(){return u.clearCanvas}}),Object.defineProperty(t,"resizeCanvas",{enumerable:!0,get:function(){return u.resizeCanvas}});var s=r(383);Object.defineProperty(t,"getUniformLocation",{enumerable:!0,get:function(){return s.getUniformLocation}})},381:(e,t)=>{function r(e,t,r){var n=e.createShader(t);if(!n)throw new Error("failed to create a shader");return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||(console.log(e.getShaderInfoLog(n)),e.deleteShader(n)),n}Object.defineProperty(t,"__esModule",{value:!0}),t.createProgram=void 0,t.createProgram=function(e,t,n){var i=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=e.createProgram();if(!n)throw new Error("failed to create program");for(var i=0,o=t.length;i<o;i++)e.attachShader(n,t[i]);return e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||(console.log(e.getProgramInfoLog(n)),e.deleteProgram(n)),n}(e,r(e,e.VERTEX_SHADER,t),r(e,e.FRAGMENT_SHADER,n));return i}},363:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uploadTexture=t.createTexture=void 0,t.createTexture=function(e,t){var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[t]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[t]),e.bindTexture(e.TEXTURE_2D,null),r},t.uploadTexture=function(e,t,r){return e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),t}},383:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUniformLocation=void 0,t.getUniformLocation=function(e,t,r){return e.getUniformLocation(t,r)}},947:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=a(r(289)),s=a(r(840)),c=o(r(97)),l=o(r(179)),f={canvas:void 0,width:300,height:150},h=function(){function e(e){this.resolution=window.devicePixelRatio||1,Object.assign(f,e);var t=f.canvas,r=f.width,n=f.height;this.canvas=t||document.createElement("canvas"),this._screenSize={width:r,height:n},this.gl=this.canvas.getContext("webgl2");var i=this.gl;this.resizeCanvas(),c.enableAlpha(i);var o=c.createProgram(i,u.default,s.default);this._program=o,this._indexBuffer=c.createRectangleIndices(i),this._vertexBuffer=c.createLinkedVertexBuffer(i,o,"a_position","a_texcoord"),this._transformUniformLocation=c.getUniformLocation(i,o,"u_transformation"),this._opacityUniformLocation=c.getUniformLocation(i,o,"u_opacity"),this._textureUniformLocation=c.getUniformLocation(i,o,"u_texture")}return e.prototype.clear=function(e,t,r,n){c.clearCanvas(this.gl,{r:e,g:t,b:r,a:n})},e.prototype.resizeCanvas=function(){c.resizeCanvas(this.gl,this.resolution)},e.prototype.flush=function(){this.gl.flush()},e.prototype.updateTexture=function(e){c.uploadTexture(this.gl,e.glTexture,e.originalImage),e.updated=!0},e.prototype.renderSprite=function(e){if(e.texture){var t=e.texture;if(t.glTexture||(t.glTexture=c.createTexture(this.gl,t.scaleMode)),t.originalImage){e.texture.updated||this.updateTexture(e.texture);var r=t.glTexture,n={w:t.width,h:t.height},i=this.gl,o=this._textureUniformLocation;i.useProgram(this._program),i.uniform1i(o,0),i.activeTexture(i.TEXTURE0+0),i.bindTexture(i.TEXTURE_2D,r);var a=l.projection(this._screenSize.width,this._screenSize.height),u=l.someMultiply(a,e.parentTransform,e.transform);i.uniformMatrix3fv(this._transformUniformLocation,!1,u);var s=e.opacity,f=e.parentOpacity*s;i.uniform1f(this._opacityUniformLocation,f);var h=this._vertexBuffer;i.bindBuffer(i.ARRAY_BUFFER,h);var d=[0,0,0,0,0,n.h,0,1,n.w,0,1,0,n.w,n.h,1,1];i.bufferData(i.ARRAY_BUFFER,new Float32Array(d),i.DYNAMIC_DRAW);var p=this._indexBuffer;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,p),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,null),i.bindBuffer(i.ARRAY_BUFFER,null),i.bindTexture(i.TEXTURE_2D,null)}}},e}();t.default=h},59:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){void 0===t&&(t="LINEAR"),this.width=1,this.height=1,this.updated=!1,this.scaleMode="LINEAR",this.originalImage=e,this.scaleMode=t,this.width=e.width,this.height=e.height}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(607)})()}));