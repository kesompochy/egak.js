<<<<<<< HEAD
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("EGAK",[],t):"object"==typeof exports?exports.EGAK=t():e.EGAK=t()}(self,(function(){return(()=>{"use strict";var e={840:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n="#version 300 es\r\nprecision highp float;\r\n\r\nin vec2 v_texcoord;\r\n\r\nuniform sampler2D u_texture;\r\n\r\nuniform float u_opacity;\r\n\r\nout vec4 outColor;\r\n\r\nvoid main() {\r\n   outColor = texture(u_texture, v_texcoord) * vec4(1, 1, 1, u_opacity);\r\n}"},289:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n="#version 300 es\r\n \r\nin vec2 a_position;\r\nin vec2 a_texcoord;\r\n \r\nuniform mat3 u_transformation;\r\n \r\nout vec2 v_texcoord;\r\n \r\nvoid main() {\r\n   v_texcoord = a_texcoord;\r\n\r\n   gl_Position = vec4((u_transformation * vec3(a_position, 1)).xy, 0, 1);\r\n}"},178:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultResolution=void 0;var i=n(r(947)),o=n(r(108)),a=n(r(627)),u=n(r(991)),s=r(236),c={width:300,height:150,canvas:document.createElement("canvas"),autoStyleCanvas:!1};t.defaultResolution={x:1,y:1};var f=function(){function e(e){this.loader=o.default,e||(e=c);var t=e.width||c.width,r=e.height||c.height,n=e.canvas||c.canvas,f=e.autoStyleCanvas||c.autoStyleCanvas;this.baseStage=new s.BaseStage(t,r),this._canvas=n,f&&(this._canvas.style.width="".concat(t,"px"),this._canvas.style.height="".concat(r,"px")),this._screenSize={width:t,height:r},this.renderer=new i.default({canvas:n,width:this._screenSize.width,height:this._screenSize.height}),a.default.x=this._resolutionX,a.default.y=this._resolutionY,u.default.canvas=n,u.default.on(),u.default.screenSize=this._screenSize}return Object.defineProperty(e.prototype,"width",{set:function(e){this._screenSize.width=e,this.renderer.width=e,a.default.x=this._resolutionX},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{set:function(e){this._screenSize.height=e,this.renderer.height=e,a.default.y=this._resolutionY},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_resolutionX",{get:function(){return this.renderer.resolution*this._canvas.width/this._screenSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_resolutionY",{get:function(){return this.renderer.resolution*this._canvas.height/this._screenSize.height},enumerable:!1,configurable:!0}),e.prototype.render=function(){this.renderer.render(this.baseStage),this.renderer.flush()},e.prototype.clearScreen=function(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.renderer.clear(e,t,r,n)},e}();t.default=f},309:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.TwoDemensionParam=void 0;var i,o=function(){function e(){this._x=1,this._y=1}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t){this._x=e,this._y=t||e},e}();t.TwoDemensionParam=o,n((function(){var e=i.call(this)||this;return e._x=0,e._y=0,e}),i=o);var a=function(){function e(){this._position=new o,this._opacity=1,this._scale=new o,this.rotation=0}return Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity=Math.min(Math.max(e,0),1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},enumerable:!1,configurable:!0}),e}();t.default=a},479:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r,n){this.x=0,this.y=0,this.w=0,this.h=0,this.x=e,this.y=t,this.w=r,this.h=n}return e.prototype.detectPointHit=function(e,t){return this.x<e&&this.x+this.w>e&&this.y<t&&this.y+this.h>t},e}();t.default=r},339:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var r=e.call(this)||this;return t&&(r.texture=t),r}return i(t,e),t}(o(r(236)).default);t.default=a},236:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return a(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStage=void 0;var c=s(r(309)),f=r(309),l=s(r(991)),h=u(r(179)),d=s(r(479)),p=r(991),_=function(e){function t(){var t=e.call(this)||this;return t._x=0,t._y=0,t}return i(t,e),t}(f.TwoDemensionParam),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anchor=new _,t.transform=h.identity(),t.parentTransform=h.identity(),t.parentOpacity=1,t.parent=void 0,t.isOnStage=!1,t._size={width:0,height:0},t._eventsArys={pointerdown:[],pointerup:[],pointermove:[]},t.children=[],t}return i(t,e),t.prototype.calcRenderingInfos=function(){this.transform=this._calculateTransform(),this.parentTransform=this._calculateParentTransform(),this.parentOpacity=this._calculateParentOpacity()},t.prototype.addChild=function(e){this.children.push(e),e.parent=this,this.isOnStage&&(e.isOnStage=!0,p.events.forEach((function(t){e._eventsArys[t].forEach((function(e){l.default.add(t,e)}))})))},t.prototype.removeChild=function(e){this.children.splice(this.children.indexOf(e),1),e.parent=void 0,e.isOnStage=!1},t.prototype._calculateTransform=function(){var e=h.translation(this.position.x,this.position.y),t=h.scaling(this.scale.x,this.scale.y),r=h.rotation(this.rotation),n=h.translation(-this.anchor.x,-this.anchor.y);return h.someMultiply(e,r,t,n)},t.prototype._calculateParentTransform=function(){return this.parent?h.multiply(this.parent.parentTransform,this.parent.transform):h.identity()},t.prototype._calculateParentOpacity=function(){return this.parent?this.parent.parentOpacity*this.parent.opacity:1},Object.defineProperty(t.prototype,"worldScale",{get:function(){if(this.parent){var e=this.parent,t=e.worldScale;return{x:t.x*e.scale.x,y:t.y*e.scale.y}}return{x:1,y:1}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldPosition",{get:function(){if(this.parent){var e=this.parent,t=e.worldPosition,r=e.worldScale;return{x:t.x+e.position.x*r.x,y:t.y+e.position.y*r.y}}return{x:0,y:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._size.width},set:function(e){this._size.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._size.height},set:function(e){this._size.height=e},enumerable:!1,configurable:!0}),t.prototype.addEventListener=function(e,t){var r={target:this,callback:t};this._eventsArys[e].push(r),this.isOnStage&&l.default.add(e,r)},t.prototype.getBoundingRect=function(){var e=this.worldScale,t=this.worldPosition,r=t.x+(this.position.x-this.anchor.x)*e.x,n=t.y+(this.position.y-this.anchor.y)*e.y,i=(this.texture?this.texture.width*this.texture.scale.x:this._size.width)*this.scale.x*e.x,o=(this.texture?this.texture.height*this.texture.scale.y:this._size.height)*this.scale.y*e.y;return new d.default(r,n,i,o)},t}(c.default);t.default=v;var y=function(e){function t(t,r){var n=e.call(this)||this;return n.isOnStage=!0,n._size={width:t,height:r},n}return i(t,e),t}(v);t.BaseStage=y},736:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(r(339)),u=o(r(59)),s=o(r(627)),c=r(59),f={font:"sans-serif",fontSize:20,fill:"#f00",strokeWidth:0,stroke:"#000",shadow:"",shadowX:1,shadowY:1,shadowBlur:0},l=function(e){function t(t,r){var n=e.call(this)||this;for(var i in n._text="",n._canvas=document.createElement("canvas"),n._resolution=s.default,n._text=t||"",r=r||f,n._style=r,f)n._style[i]=r[i]||f[i];return n.texture=new u.default(void 0,c.SCALE_MODE.LINEAR),n._updateCanvasTexture(),n}return i(t,e),t.prototype._drawCanvas=function(){var e=this._canvas,t=e.getContext("2d"),r=this._style,n=this._text;e.width=2,e.height=2,t.font="".concat(r.fontSize,"px ").concat(r.font),t.textBaseline="top";var i=t.measureText(n),o=i.width+(r.shadow?r.shadowX:0),a=i.actualBoundingBoxDescent-i.actualBoundingBoxAscent+(r.shadow?r.shadowY:0);e.width=o*this._resolution.x,e.height=a*this._resolution.y,t.scale(this._resolution.x,this._resolution.y),t.clearRect(0,0,e.width,e.height),t.beginPath(),r.shadow&&(t.shadowOffsetX=r.shadowX,t.shadowOffsetY=r.shadowY,t.shadowBlur=r.shadowBlur,t.shadowColor=r.shadow),t.font="".concat(r.fontSize,"px ").concat(r.font),t.textBaseline="top",t.fillStyle=r.fill,t.fillText(n,0,0),t.closePath(),t.beginPath(),r.strokeWidth&&(t.shadowOffsetX=0,t.shadowOffsetY=0,t.lineWidth=r.strokeWidth,t.strokeStyle=r.stroke,t.strokeText(n,0,0)),this.texture.scale.x=1/this._resolution.x,this.texture.scale.y=1/this._resolution.y},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this._updateCanvasTexture()},enumerable:!1,configurable:!0}),t.prototype._updateCanvasTexture=function(){this._drawCanvas(),this.texture.texture=this._canvas},Object.defineProperty(t.prototype,"style",{get:function(){return this._updateCanvasTexture(),this._style},enumerable:!1,configurable:!0}),t}(a.default);t.default=l},607:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Text=t.Stage=t.Texture=t.Sprite=t.App=void 0;var i=n(r(178));t.App=i.default;var o=n(r(339));t.Sprite=o.default;var a=n(r(59));t.Texture=a.default;var u=n(r(236));t.Stage=u.default;var s=n(r(736));t.Text=s.default},991:function(e,t){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.events=void 0;var n=["pointerdown","pointerup","pointermove"];t.events=n;var i=function(){function e(){}var t;return e._getPointerCo=function(e){var t=this._canvasSize;return{x:e.offsetX*this.screenSize.width/t.w,y:e.offsetY*this.screenSize.height/t.h}},e.on=function(){var e,t,i,o=this,a=function(e){null===(i=u._canvas)||void 0===i||i.addEventListener(e,(function(t){var r=o._getPointerCo(t);o._dispatchEvents(e,r)}))},u=this;try{for(var s=r(Object.values(n)),c=s.next();!c.done;c=s.next())a(c.value)}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}},e._dispatchEvents=function(e,t){for(var r=this._eventsArys[e],n=0,i=r.length;n<i;n++){var o=r[n],a=o.target;a.isOnStage&&a.getBoundingRect().detectPointHit(t.x,t.y)&&o.callback()}},Object.defineProperty(e,"canvas",{set:function(e){this._canvas=e,this._canvasSize=this._getCanvasSize(e),this._resizeObserver.observe(document.body)},enumerable:!1,configurable:!0}),e._getCanvasSize=function(e){return{w:e.clientWidth,h:e.clientHeight}},e.add=function(e,t){this._eventsArys[e].push({target:t.target,callback:t.callback})},t=e,e.screenSize={width:0,height:0},e._canvasSize={w:0,h:0},e._eventsArys={pointerup:[],pointerdown:[],pointermove:[]},e._resizeObserver=new ResizeObserver((function(){t._canvasSize=t._getCanvasSize(t._canvas)})),e}();t.default=i},108:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.add=function(e,t){var r=this._promiseLoadingImage(e,t);return this._tasks.push(r),this},e.loadAll=function(){var e=this;this._taskNum=this._tasks.length,this._progressManager(this._taskNum,this._taskNum),Promise.all(this._tasks).then((function(){e._loadThen()}))},e._promiseLoadingImage=function(e,t){var r=this;return new Promise((function(n){fetch(t).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e)})).then((function(t){r._resources.set(e,t),r._tasks.shift(),r._progressManager(r._taskNum,r._tasks.length),n(t)}))}))},e.loadThen=function(e){return this._loadThen=e,0===this._tasks.length&&e(),this},e.manageProgress=function(e){this._progressManager=e},e.get=function(e){return this._resources.has(e)?this._resources.get(e):void 0},e._resources=new Map,e._tasks=[],e._loadThen=function(){},e._taskNum=0,e._progressManager=function(){},e}();t.default=r},179:(e,t)=>{function r(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=t[0],h=t[1],d=t[2],p=t[3],_=t[4],v=t[5],y=t[6],g=t[7],b=t[8];return[l*r+h*o+d*s,l*n+h*a+d*c,l*i+h*u+d*f,p*r+_*o+v*s,p*n+_*a+v*c,p*i+_*u+v*f,y*r+g*o+b*s,y*n+g*a+b*c,y*i+g*u+b*f]}Object.defineProperty(t,"__esModule",{value:!0}),t.identity=t.someMultiply=t.multiply=t.rotation=t.translation=t.scaling=t.projection=void 0,t.projection=function(e,t){return[2/e,0,0,0,-2/t,0,-1,1,1]},t.scaling=function(e,t){return[e,0,0,0,t,0,0,0,1]},t.translation=function(e,t){return[1,0,0,0,1,0,e,t,1]},t.rotation=function(e){var t=Math.sin(e),r=Math.cos(e);return[r,-t,0,t,r,0,0,0,1]},t.multiply=r,t.someMultiply=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e[0],i=0,o=e.length-1;i<o;i++)n=r(n,e[i+1]);return n},t.identity=function(){return[1,0,0,0,1,0,0,0,1]}},478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableAlpha=void 0,t.enableAlpha=function(e){e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0)}},144:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRectangleIndices=t.createLinkedVertexBuffer=void 0,t.createLinkedVertexBuffer=function(e,t,r,n){var i=e.getAttribLocation(t,r),o=e.getAttribLocation(t,n);e.enableVertexAttribArray(i),e.enableVertexAttribArray(o);var a=e.FLOAT,u=4*Float32Array.BYTES_PER_ELEMENT,s=2*Float32Array.BYTES_PER_ELEMENT,c=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,c),e.vertexAttribPointer(i,2,a,!1,u,0),e.vertexAttribPointer(o,2,a,!1,u,s),e.bindBuffer(e.ARRAY_BUFFER,null),c},t.createRectangleIndices=function(e){var t=new Uint16Array([0,1,2,1,3,2]),r=function(e,t,r){var n=e.createBuffer();return e.bindBuffer(t,n),e.bufferData(t,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),n}(e,e.ELEMENT_ARRAY_BUFFER,t);return r}},484:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resizeCanvas=t.clearCanvas=void 0,t.clearCanvas=function(e,t){var r=t.r/256,n=t.g/256,i=t.b/256,o=void 0===t.a?1:t.a;e.clearColor(r,n,i,o),e.clear(e.COLOR_BUFFER_BIT)},t.resizeCanvas=function(e,t){var r=e.canvas,n=r.clientWidth,i=r.clientHeight;r.width=n*t,r.height=i*t,e.viewport(0,0,r.width,r.height)}},97:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUniformLocation=t.resizeCanvas=t.clearCanvas=t.enableAlpha=t.uploadTexture=t.createTexture=t.createLinkedVertexBuffer=t.createRectangleIndices=t.createProgram=void 0;var n=r(381);Object.defineProperty(t,"createProgram",{enumerable:!0,get:function(){return n.createProgram}});var i=r(144);Object.defineProperty(t,"createLinkedVertexBuffer",{enumerable:!0,get:function(){return i.createLinkedVertexBuffer}}),Object.defineProperty(t,"createRectangleIndices",{enumerable:!0,get:function(){return i.createRectangleIndices}});var o=r(363);Object.defineProperty(t,"createTexture",{enumerable:!0,get:function(){return o.createTexture}}),Object.defineProperty(t,"uploadTexture",{enumerable:!0,get:function(){return o.uploadTexture}});var a=r(478);Object.defineProperty(t,"enableAlpha",{enumerable:!0,get:function(){return a.enableAlpha}});var u=r(484);Object.defineProperty(t,"clearCanvas",{enumerable:!0,get:function(){return u.clearCanvas}}),Object.defineProperty(t,"resizeCanvas",{enumerable:!0,get:function(){return u.resizeCanvas}});var s=r(383);Object.defineProperty(t,"getUniformLocation",{enumerable:!0,get:function(){return s.getUniformLocation}})},381:(e,t)=>{function r(e,t,r){var n=e.createShader(t);if(!n)throw new Error("failed to create a shader");return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||(console.log(e.getShaderInfoLog(n)),e.deleteShader(n)),n}Object.defineProperty(t,"__esModule",{value:!0}),t.createProgram=void 0,t.createProgram=function(e,t,n){var i=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=e.createProgram();if(!n)throw new Error("failed to create program");for(var i=0,o=t.length;i<o;i++)e.attachShader(n,t[i]);return e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||(console.log(e.getProgramInfoLog(n)),e.deleteProgram(n)),n}(e,r(e,e.VERTEX_SHADER,t),r(e,e.FRAGMENT_SHADER,n));return i}},363:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uploadTexture=t.createTexture=void 0,t.createTexture=function(e,t){var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[t]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[t]),e.bindTexture(e.TEXTURE_2D,null),r},t.uploadTexture=function(e,t,r){return e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),t}},383:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUniformLocation=void 0,t.getUniformLocation=function(e,t,r){return e.getUniformLocation(t,r)}},947:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=a(r(483)),s=a(r(289)),c=a(r(840)),f=o(r(97)),l=o(r(179)),h=function(){function e(e){this.resolution=window.devicePixelRatio||1;var t=e.canvas,r=e.width,n=e.height;this.canvas=t,this._screenSize={width:r,height:n},this.gl=this.canvas.getContext("webgl2");var i=this.gl;u.default.gl=i,this.resizeCanvas(),f.enableAlpha(i);var o=f.createProgram(i,s.default,c.default);this._program=o,this._indexBuffer=f.createRectangleIndices(i),this._vertexBuffer=f.createLinkedVertexBuffer(i,o,"a_position","a_texcoord"),this._transformUniformLocation=f.getUniformLocation(i,o,"u_transformation"),this._opacityUniformLocation=f.getUniformLocation(i,o,"u_opacity"),this._textureUniformLocation=f.getUniformLocation(i,o,"u_texture")}return e.prototype.clear=function(e,t,r,n){f.clearCanvas(this.gl,{r:e,g:t,b:r,a:n})},e.prototype.resizeCanvas=function(){f.resizeCanvas(this.gl,this.resolution)},Object.defineProperty(e.prototype,"width",{set:function(e){this._screenSize.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{set:function(e){this._screenSize.height=e},enumerable:!1,configurable:!0}),e.prototype.flush=function(){this.gl.flush()},e.prototype.render=function(e){e.calcRenderingInfos(),e.texture&&this.renderSprite(e);for(var t=e.children,r=0,n=t.length;r<n;r++)this.render(t[r])},e.prototype.renderSprite=function(e){var t=e.texture;if(t){var r=t.glTexture,n=this.gl,i=this._textureUniformLocation;n.useProgram(this._program),n.uniform1i(i,0),n.activeTexture(n.TEXTURE0+0),n.bindTexture(n.TEXTURE_2D,r);var o=l.projection(this._screenSize.width,this._screenSize.height),a=l.scaling(t.scale.x,t.scale.y),u=l.someMultiply(o,e.parentTransform,e.transform,a);n.uniformMatrix3fv(this._transformUniformLocation,!1,u);var s=e.opacity,c=e.parentOpacity*s;n.uniform1f(this._opacityUniformLocation,c);var f=this._vertexBuffer;n.bindBuffer(n.ARRAY_BUFFER,f);var h={w:t.width,h:t.height},d=[0,0,0,0,0,h.h,0,1,h.w,0,1,0,h.w,h.h,1,1];n.bufferData(n.ARRAY_BUFFER,new Float32Array(d),n.DYNAMIC_DRAW);var p=this._indexBuffer;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,p),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},e}();t.default=h},483:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.checkGL=function(){if(e.gl)return e.gl;throw new Error("There seems to be no canvas")},e}();t.default=r},627:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.x=1,e.y=1,e}();t.default=r},59:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SCALE_MODE=void 0;var u,s=a(r(483)),c=o(r(97));!function(e){e.LINEAR="LINEAR",e.NEAREST="NEAREST"}(u=t.SCALE_MODE||(t.SCALE_MODE={}));var f=r(309),l=function(){function e(e,t){void 0===t&&(t=u.NEAREST),this._width=0,this._height=0,this._scale=new f.TwoDemensionParam,this.scaleMode=u.NEAREST,this.scaleMode=t;var r=s.default.checkGL(),n=c.createTexture(r,t);e?(this.glTexture=c.uploadTexture(r,n,e),this._width=e.width,this._height=e.height):this.glTexture=n}return Object.defineProperty(e.prototype,"texture",{set:function(e){var t=s.default.checkGL();this.glTexture=c.uploadTexture(t,this.glTexture,e),this._width=e.width,this._height=e.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e}();t.default=l}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(607)})()}));
=======
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("EGAK",[],t):"object"==typeof exports?exports.EGAK=t():e.EGAK=t()}(self,(function(){return(()=>{"use strict";var e={840:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n="#version 300 es\r\nprecision highp float;\r\n\r\nin vec2 v_texcoord;\r\n\r\nuniform sampler2D u_texture;\r\n\r\nuniform float u_opacity;\r\n\r\nout vec4 outColor;\r\n\r\nvoid main() {\r\n   outColor = texture(u_texture, v_texcoord) * vec4(1, 1, 1, u_opacity);\r\n}"},289:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const n="#version 300 es\r\n \r\nin vec2 a_position;\r\nin vec2 a_texcoord;\r\n \r\nuniform mat3 u_transformation;\r\n \r\nout vec2 v_texcoord;\r\n \r\nvoid main() {\r\n   v_texcoord = a_texcoord;\r\n\r\n   gl_Position = vec4((u_transformation * vec3(a_position, 1)).xy, 0, 1);\r\n}"},178:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultResolution=void 0;var i=n(r(947)),o=n(r(108)),a=n(r(627)),u=n(r(991)),s=r(236),c={width:300,height:150,canvas:document.createElement("canvas"),autoStyleCanvas:!1};t.defaultResolution={x:1,y:1};var l=function(){function e(e){this.loader=o.default,e||(e=c);var t=e.width||c.width,r=e.height||c.height,n=e.canvas||c.canvas,l=e.autoStyleCanvas||c.autoStyleCanvas;this.baseStage=new s.BaseStage(t,r),this._canvas=n,l&&(this._canvas.style.width="".concat(t,"px"),this._canvas.style.height="".concat(r,"px")),this._screenSize={width:t,height:r},this.renderer=new i.default({canvas:n,width:this._screenSize.width,height:this._screenSize.height}),a.default.x=this._resolutionX,a.default.y=this._resolutionY,u.default.canvas=n,u.default.on(),u.default.screenSize=this._screenSize}return Object.defineProperty(e.prototype,"width",{set:function(e){this._screenSize.width=e,this.renderer.width=e,a.default.x=this._resolutionX},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{set:function(e){this._screenSize.height=e,this.renderer.height=e,a.default.y=this._resolutionY},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_resolutionX",{get:function(){return this.renderer.resolution*this._canvas.width/this._screenSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_resolutionY",{get:function(){return this.renderer.resolution*this._canvas.height/this._screenSize.height},enumerable:!1,configurable:!0}),e.prototype.render=function(){this.renderer.render(this.baseStage),this.renderer.flush()},e.prototype.clearScreen=function(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.renderer.clear(e,t,r,n)},e.prototype.addResource=function(e,t){this.loader.add(e,t)},e.prototype.loadAll=function(){this.loader.loadAll()},e}();t.default=l},309:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.TwoDemensionParam=void 0;var i,o=function(){function e(){this._x=1,this._y=1}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t){this._x=e,this._y=t||e},e}();t.TwoDemensionParam=o,n((function(){var e=i.call(this)||this;return e._x=0,e._y=0,e}),i=o);var a=function(){function e(){this._position=new o,this._opacity=1,this._scale=new o,this.rotation=0}return Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity=Math.min(Math.max(e,0),1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},enumerable:!1,configurable:!0}),e}();t.default=a},479:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r,n){this.x=0,this.y=0,this.w=0,this.h=0,this.x=e,this.y=t,this.w=r,this.h=n}return e.prototype.detectPointHit=function(e,t){return this.x<e&&this.x+this.w>e&&this.y<t&&this.y+this.h>t},e}();t.default=r},339:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var r=e.call(this)||this;return t&&(r.texture=t),r}return i(t,e),t}(o(r(236)).default);t.default=a},236:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return a(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStage=void 0;var c=s(r(309)),l=r(309),f=s(r(991)),h=u(r(179)),d=s(r(479)),p=r(991),_=function(e){function t(){var t=e.call(this)||this;return t._x=0,t._y=0,t}return i(t,e),t}(l.TwoDemensionParam),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anchor=new _,t.transform=h.identity(),t.parentTransform=h.identity(),t.parentOpacity=1,t.parent=void 0,t.isOnStage=!1,t._size={width:0,height:0},t._eventsArys={pointerdown:[],pointerup:[],pointermove:[]},t.children=[],t}return i(t,e),t.prototype.calcRenderingInfos=function(){this.transform=this._calculateTransform(),this.parentTransform=this._calculateParentTransform(),this.parentOpacity=this._calculateParentOpacity()},t.prototype.addChild=function(e){this.children.push(e),e.parent=this,this.isOnStage&&(e.isOnStage=!0,p.events.forEach((function(t){e._eventsArys[t].forEach((function(e){f.default.add(t,e)}))})))},t.prototype.removeChild=function(e){this.children.splice(this.children.indexOf(e),1),e.parent=void 0,e.isOnStage=!1},t.prototype._calculateTransform=function(){var e=h.translation(this.position.x,this.position.y),t=h.scaling(this.scale.x,this.scale.y),r=h.rotation(this.rotation),n=h.translation(-this.anchor.x,-this.anchor.y);return h.someMultiply(e,r,t,n)},t.prototype._calculateParentTransform=function(){return this.parent?h.multiply(this.parent.parentTransform,this.parent.transform):h.identity()},t.prototype._calculateParentOpacity=function(){return this.parent?this.parent.parentOpacity*this.parent.opacity:1},Object.defineProperty(t.prototype,"worldScale",{get:function(){if(this.parent){var e=this.parent,t=e.worldScale;return{x:t.x*e.scale.x,y:t.y*e.scale.y}}return{x:1,y:1}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldPosition",{get:function(){if(this.parent){var e=this.parent,t=e.worldPosition,r=e.worldScale;return{x:t.x+e.position.x*r.x,y:t.y+e.position.y*r.y}}return{x:0,y:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._size.width},set:function(e){this._size.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._size.height},set:function(e){this._size.height=e},enumerable:!1,configurable:!0}),t.prototype.addEventListener=function(e,t){var r={target:this,callback:t};this._eventsArys[e].push(r),this.isOnStage&&f.default.add(e,r)},t.prototype.getBoundingRect=function(){var e=this.worldScale,t=this.worldPosition,r=t.x+(this.position.x-this.anchor.x)*e.x,n=t.y+(this.position.y-this.anchor.y)*e.y,i=(this.texture?this.texture.width*this.texture.scale.x:this._size.width)*this.scale.x*e.x,o=(this.texture?this.texture.height*this.texture.scale.y:this._size.height)*this.scale.y*e.y;return new d.default(r,n,i,o)},t}(c.default);t.default=v;var y=function(e){function t(t,r){var n=e.call(this)||this;return n.isOnStage=!0,n._size={width:t,height:r},n}return i(t,e),t}(v);t.BaseStage=y},736:function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(r(339)),u=o(r(59)),s=o(r(627)),c=r(59),l={font:"sans-serif",fontSize:20,fill:"#f00",strokeWidth:0,stroke:"#000",shadow:"",shadowX:1,shadowY:1,shadowBlur:0},f=function(e){function t(t,r){var n=e.call(this)||this;for(var i in n._text="",n._canvas=document.createElement("canvas"),n._resolution=s.default,n._text=t||"",r=r||l,n._style=r,l)n._style[i]=r[i]||l[i];return n.texture=new u.default(void 0,c.SCALE_MODE.LINEAR),n._updateCanvasTexture(),n}return i(t,e),t.prototype._drawCanvas=function(){var e=this._canvas,t=e.getContext("2d"),r=this._style,n=this._text;e.width=2,e.height=2,t.font="".concat(r.fontSize,"px ").concat(r.font),t.textBaseline="top";var i=t.measureText(n),o=i.width+(r.shadow?r.shadowX:0),a=i.actualBoundingBoxDescent-i.actualBoundingBoxAscent+(r.shadow?r.shadowY:0);e.width=o*this._resolution.x,e.height=a*this._resolution.y,t.scale(this._resolution.x,this._resolution.y),t.clearRect(0,0,e.width,e.height),t.beginPath(),r.shadow&&(t.shadowOffsetX=r.shadowX,t.shadowOffsetY=r.shadowY,t.shadowBlur=r.shadowBlur,t.shadowColor=r.shadow),t.font="".concat(r.fontSize,"px ").concat(r.font),t.textBaseline="top",t.fillStyle=r.fill,t.fillText(n,0,0),t.closePath(),t.beginPath(),r.strokeWidth&&(t.shadowOffsetX=0,t.shadowOffsetY=0,t.lineWidth=r.strokeWidth,t.strokeStyle=r.stroke,t.strokeText(n,0,0)),this.texture.scale.x=1/this._resolution.x,this.texture.scale.y=1/this._resolution.y},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this._text=e,this._updateCanvasTexture()},enumerable:!1,configurable:!0}),t.prototype._updateCanvasTexture=function(){this._drawCanvas(),this.texture.texture=this._canvas},Object.defineProperty(t.prototype,"style",{get:function(){return this._updateCanvasTexture(),this._style},enumerable:!1,configurable:!0}),t}(a.default);t.default=f},607:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Text=t.Stage=t.Texture=t.Sprite=t.App=void 0;var i=n(r(178));t.App=i.default;var o=n(r(339));t.Sprite=o.default;var a=n(r(59));t.Texture=a.default;var u=n(r(236));t.Stage=u.default;var s=n(r(736));t.Text=s.default},991:function(e,t){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.events=void 0;var n=["pointerdown","pointerup","pointermove"];t.events=n;var i=function(){function e(){}var t;return e._getPointerCo=function(e){var t=this._canvasSize;return{x:e.offsetX*this.screenSize.width/t.w,y:e.offsetY*this.screenSize.height/t.h}},e.on=function(){var e,t,i,o=this,a=function(e){null===(i=u._canvas)||void 0===i||i.addEventListener(e,(function(t){var r=o._getPointerCo(t);o._dispatchEvents(e,r)}))},u=this;try{for(var s=r(Object.values(n)),c=s.next();!c.done;c=s.next())a(c.value)}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}},e._dispatchEvents=function(e,t){for(var r=this._eventsArys[e],n=0,i=r.length;n<i;n++){var o=r[n],a=o.target;a.isOnStage&&a.getBoundingRect().detectPointHit(t.x,t.y)&&o.callback()}},Object.defineProperty(e,"canvas",{set:function(e){this._canvas=e,this._canvasSize=this._getCanvasSize(e),this._resizeObserver.observe(document.body)},enumerable:!1,configurable:!0}),e._getCanvasSize=function(e){return{w:e.clientWidth,h:e.clientHeight}},e.add=function(e,t){this._eventsArys[e].push({target:t.target,callback:t.callback})},t=e,e.screenSize={width:0,height:0},e._canvasSize={w:0,h:0},e._eventsArys={pointerup:[],pointerdown:[],pointermove:[]},e._resizeObserver=new ResizeObserver((function(){t._canvasSize=t._getCanvasSize(t._canvas)})),e}();t.default=i},108:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.add=function(e,t){var r=this._promiseLoadingImage(e,t);return this._tasks.push(r),this},e.loadAll=function(){var e=this;this._taskNum=this._tasks.length,this._progressManager(this._taskNum,this._taskNum),Promise.all(this._tasks).then((function(){e._loadThen()}))},e._promiseLoadingImage=function(e,t){var r=this;return new Promise((function(n){fetch(t).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e)})).then((function(t){r._resources.set(e,t),r._tasks.shift(),r._progressManager(r._taskNum,r._tasks.length),n(t)}))}))},e.loadThen=function(e){this._loadThen=e,0===this._tasks.length&&e()},e.manageProgress=function(e){this._progressManager=e},e.get=function(e){return this._resources.has(e)?this._resources.get(e):void 0},e._resources=new Map,e._tasks=[],e._loadThen=function(){},e._taskNum=0,e._progressManager=function(){},e}();t.default=r},179:(e,t)=>{function r(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],l=e[8],f=t[0],h=t[1],d=t[2],p=t[3],_=t[4],v=t[5],y=t[6],g=t[7],b=t[8];return[f*r+h*o+d*s,f*n+h*a+d*c,f*i+h*u+d*l,p*r+_*o+v*s,p*n+_*a+v*c,p*i+_*u+v*l,y*r+g*o+b*s,y*n+g*a+b*c,y*i+g*u+b*l]}Object.defineProperty(t,"__esModule",{value:!0}),t.identity=t.someMultiply=t.multiply=t.rotation=t.translation=t.scaling=t.projection=void 0,t.projection=function(e,t){return[2/e,0,0,0,-2/t,0,-1,1,1]},t.scaling=function(e,t){return[e,0,0,0,t,0,0,0,1]},t.translation=function(e,t){return[1,0,0,0,1,0,e,t,1]},t.rotation=function(e){var t=Math.sin(e),r=Math.cos(e);return[r,-t,0,t,r,0,0,0,1]},t.multiply=r,t.someMultiply=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e[0],i=0,o=e.length-1;i<o;i++)n=r(n,e[i+1]);return n},t.identity=function(){return[1,0,0,0,1,0,0,0,1]}},478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableAlpha=void 0,t.enableAlpha=function(e){e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0)}},144:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRectangleIndices=t.createLinkedVertexBuffer=void 0,t.createLinkedVertexBuffer=function(e,t,r,n){var i=e.getAttribLocation(t,r),o=e.getAttribLocation(t,n);e.enableVertexAttribArray(i),e.enableVertexAttribArray(o);var a=e.FLOAT,u=4*Float32Array.BYTES_PER_ELEMENT,s=2*Float32Array.BYTES_PER_ELEMENT,c=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,c),e.vertexAttribPointer(i,2,a,!1,u,0),e.vertexAttribPointer(o,2,a,!1,u,s),e.bindBuffer(e.ARRAY_BUFFER,null),c},t.createRectangleIndices=function(e){var t=new Uint16Array([0,1,2,1,3,2]),r=function(e,t,r){var n=e.createBuffer();return e.bindBuffer(t,n),e.bufferData(t,r,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),n}(e,e.ELEMENT_ARRAY_BUFFER,t);return r}},484:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resizeCanvas=t.clearCanvas=void 0,t.clearCanvas=function(e,t){var r=t.r/256,n=t.g/256,i=t.b/256,o=void 0===t.a?1:t.a;e.clearColor(r,n,i,o),e.clear(e.COLOR_BUFFER_BIT)},t.resizeCanvas=function(e,t){var r=e.canvas,n=r.clientWidth,i=r.clientHeight;r.width=n*t,r.height=i*t,e.viewport(0,0,r.width,r.height)}},97:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUniformLocation=t.resizeCanvas=t.clearCanvas=t.enableAlpha=t.uploadTexture=t.createTexture=t.createLinkedVertexBuffer=t.createRectangleIndices=t.createProgram=void 0;var n=r(381);Object.defineProperty(t,"createProgram",{enumerable:!0,get:function(){return n.createProgram}});var i=r(144);Object.defineProperty(t,"createLinkedVertexBuffer",{enumerable:!0,get:function(){return i.createLinkedVertexBuffer}}),Object.defineProperty(t,"createRectangleIndices",{enumerable:!0,get:function(){return i.createRectangleIndices}});var o=r(363);Object.defineProperty(t,"createTexture",{enumerable:!0,get:function(){return o.createTexture}}),Object.defineProperty(t,"uploadTexture",{enumerable:!0,get:function(){return o.uploadTexture}});var a=r(478);Object.defineProperty(t,"enableAlpha",{enumerable:!0,get:function(){return a.enableAlpha}});var u=r(484);Object.defineProperty(t,"clearCanvas",{enumerable:!0,get:function(){return u.clearCanvas}}),Object.defineProperty(t,"resizeCanvas",{enumerable:!0,get:function(){return u.resizeCanvas}});var s=r(383);Object.defineProperty(t,"getUniformLocation",{enumerable:!0,get:function(){return s.getUniformLocation}})},381:(e,t)=>{function r(e,t,r){var n=e.createShader(t);if(!n)throw new Error("failed to create a shader");return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||(console.log(e.getShaderInfoLog(n)),e.deleteShader(n)),n}Object.defineProperty(t,"__esModule",{value:!0}),t.createProgram=void 0,t.createProgram=function(e,t,n){var i=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=e.createProgram();if(!n)throw new Error("failed to create program");for(var i=0,o=t.length;i<o;i++)e.attachShader(n,t[i]);return e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||(console.log(e.getProgramInfoLog(n)),e.deleteProgram(n)),n}(e,r(e,e.VERTEX_SHADER,t),r(e,e.FRAGMENT_SHADER,n));return i}},363:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uploadTexture=t.createTexture=void 0,t.createTexture=function(e,t){var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e[t]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e[t]),e.bindTexture(e.TEXTURE_2D,null),r},t.uploadTexture=function(e,t,r){return e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),t}},383:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUniformLocation=void 0,t.getUniformLocation=function(e,t,r){return e.getUniformLocation(t,r)}},947:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=a(r(483)),s=a(r(289)),c=a(r(840)),l=o(r(97)),f=o(r(179)),h=function(){function e(e){this.resolution=window.devicePixelRatio||1;var t=e.canvas,r=e.width,n=e.height;this.canvas=t,this._screenSize={width:r,height:n},this.gl=this.canvas.getContext("webgl2");var i=this.gl;u.default.gl=i,this.resizeCanvas(),l.enableAlpha(i);var o=l.createProgram(i,s.default,c.default);this._program=o,this._indexBuffer=l.createRectangleIndices(i),this._vertexBuffer=l.createLinkedVertexBuffer(i,o,"a_position","a_texcoord"),this._transformUniformLocation=l.getUniformLocation(i,o,"u_transformation"),this._opacityUniformLocation=l.getUniformLocation(i,o,"u_opacity"),this._textureUniformLocation=l.getUniformLocation(i,o,"u_texture")}return e.prototype.clear=function(e,t,r,n){l.clearCanvas(this.gl,{r:e,g:t,b:r,a:n})},e.prototype.resizeCanvas=function(){l.resizeCanvas(this.gl,this.resolution)},Object.defineProperty(e.prototype,"width",{set:function(e){this._screenSize.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{set:function(e){this._screenSize.height=e},enumerable:!1,configurable:!0}),e.prototype.flush=function(){this.gl.flush()},e.prototype.render=function(e){e.calcRenderingInfos(),e.texture&&this.renderSprite(e);for(var t=e.children,r=0,n=t.length;r<n;r++)this.render(t[r])},e.prototype.renderSprite=function(e){var t=e.texture;if(t){var r=t.glTexture,n=this.gl,i=this._textureUniformLocation;n.useProgram(this._program),n.uniform1i(i,0),n.activeTexture(n.TEXTURE0+0),n.bindTexture(n.TEXTURE_2D,r);var o=f.projection(this._screenSize.width,this._screenSize.height),a=f.scaling(t.scale.x,t.scale.y),u=f.someMultiply(o,e.parentTransform,e.transform,a);n.uniformMatrix3fv(this._transformUniformLocation,!1,u);var s=e.opacity,c=e.parentOpacity*s;n.uniform1f(this._opacityUniformLocation,c);var l=this._vertexBuffer;n.bindBuffer(n.ARRAY_BUFFER,l);var h={w:t.width,h:t.height},d=[0,0,0,0,0,h.h,0,1,h.w,0,1,0,h.w,h.h,1,1];n.bufferData(n.ARRAY_BUFFER,new Float32Array(d),n.DYNAMIC_DRAW);var p=this._indexBuffer;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,p),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},e}();t.default=h},483:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.checkGL=function(){if(e.gl)return e.gl;throw new Error("There seems to be no canvas")},e}();t.default=r},627:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.x=1,e.y=1,e}();t.default=r},59:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SCALE_MODE=void 0;var u,s=a(r(483)),c=o(r(97));!function(e){e.LINEAR="LINEAR",e.NEAREST="NEAREST"}(u=t.SCALE_MODE||(t.SCALE_MODE={}));var l=r(309),f=function(){function e(e,t){void 0===t&&(t=u.NEAREST),this._width=0,this._height=0,this._scale=new l.TwoDemensionParam,this.scaleMode=u.NEAREST,this.scaleMode=t;var r=s.default.checkGL(),n=c.createTexture(r,t);e?(this.glTexture=c.uploadTexture(r,n,e),this._width=e.width,this._height=e.height):this.glTexture=n}return Object.defineProperty(e.prototype,"texture",{set:function(e){var t=s.default.checkGL();this.glTexture=c.uploadTexture(t,this.glTexture,e),this._width=e.width,this._height=e.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e}();t.default=f}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(607)})()}));
>>>>>>> dev
